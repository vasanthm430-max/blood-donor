CREATE DATABASE IF NOT EXISTS blooddb;
USE blooddb;

CREATE TABLE IF NOT EXISTS donors (
  id INT AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(120) NOT NULL,
  email VARCHAR(120),
  phone VARCHAR(20),
  blood_group VARCHAR(5) NOT NULL,
  city VARCHAR(100) NOT NULL,
  availability TINYINT(1) DEFAULT 1,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS requests (
  id INT AUTO_INCREMENT PRIMARY KEY,
  requester_name VARCHAR(120) NOT NULL,
  contact VARCHAR(60),
  blood_group VARCHAR(5) NOT NULL,
  city VARCHAR(100) NOT NULL,
  details TEXT,
  status VARCHAR(20) DEFAULT 'open',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- sample donor
INSERT INTO donors (name, email, phone, blood_group, city)
VALUES ('Ravi Kumar','ravi@example.com','9876543210','A+','Chennai');
<?php
// includes/connect.php
$host = '127.0.0.1';
$user = 'root';
$pass = ''; // default for XAMPP; change if needed
$db   = 'blooddb';

$conn = new mysqli($host, $user, $pass, $db);
if ($conn->connect_error) {
    die("Connection failed: " . $conn->connect_error);
}
$conn->set_charset("utf8mb4");
?>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Blood Donation Portal</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <header class="site-header">
    <div class="container">
      <h1>Blood Donation Portal</h1>
      <nav>
        <a href="index.html">Home</a>
        <a href="register.html">Register as Donor</a>
        <a href="search.html">Search Donors</a>
        <a href="request.html">Post Request</a>
        <a href="admin.html">Admin</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <section class="hero">
      <h2>Connecting donors and people in need</h2>
      <p>Find donors by blood group and city — or register to donate.</p>
      <div class="cta">
        <a class="btn" href="search.html">Search Donors</a>
        <a class="btn outline" href="register.html">Register</a>
      </div>
    </section>

    <section class="how">
      <h3>How it works</h3>
      <ol>
        <li>Donor registers with blood group & city.</li>
        <li>Recipients search donors and contact them.</li>
        <li>Admins verify donors (manual step in this demo).</li>
      </ol>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">
      <small>&copy; 2025 Blood Donation Portal</small>
    </div>
  </footer>
  <script src="assets/script.js"></script>
</body>
</html>
/* assets/styles.css - simple clean layout */
:root{
  --accent: #c62828;
  --dark: #222;
  --muted:#666;
  --card-bg:#fff;
}
*{box-sizing:border-box}
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; background:#f6f6f7; color:var(--dark)}
.container{max-width:980px;margin:0 auto;padding:20px}
.site-header{background:var(--card-bg);border-bottom:1px solid #eee;padding:14px 0}
.site-header h1{margin:0;display:inline-block;font-size:20px;color:var(--accent)}
.site-header nav{float:right}
.site-header nav a{margin-left:14px;text-decoration:none;color:var(--dark);font-weight:600}
.hero{background:#fff;padding:28px;border-radius:10px;box-shadow:0 6px 14px rgba(0,0,0,0.04);margin:18px 0}
.hero h2{margin-top:0;color:var(--accent)}
.cta{margin-top:12px}
.btn{display:inline-block;padding:10px 16px;border-radius:8px;text-decoration:none;background:var(--accent);color:white;font-weight:700}
.btn.outline{background:transparent;color:var(--accent);border:2px solid var(--accent);margin-left:8px}
.how{background:#fff;padding:18px;border-radius:10px;margin-bottom:24px}
.form-card{background:#fff;padding:18px;border-radius:10px;margin:12px 0;box-shadow:0 6px 14px rgba(0,0,0,0.03)}
label{display:block;margin:8px 0 6px;font-weight:600}
input[type="text"], input[type="email"], select, textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:8px}
input[type="submit"], button{margin-top:12px;padding:10px 16px;border-radius:8px;border:none;background:var(--accent);color:#fff;font-weight:700}
.search-results{margin-top:12px}
.table{width:100%;border-collapse:collapse}
.table th,.table td{padding:8px;border-bottom:1px solid #eee;text-align:left}
.site-footer{padding:20px;text-align:center;color:var(--muted)}
@media (max-width:600px){
  .site-header nav{float:none;margin-top:10px}
  .site-header h1{display:block}
}
// assets/script.js
document.addEventListener('DOMContentLoaded', ()=> {
  // simple client-side form check (demo)
  const regForm = document.getElementById('donor-form');
  if (regForm) {
    regForm.addEventListener('submit', (e)=> {
      const name = regForm.querySelector('[name="name"]').value.trim();
      const bg = regForm.querySelector('[name="blood_group"]').value;
      const city = regForm.querySelector('[name="city"]').value.trim();
      if (!name || !bg || !city) {
        e.preventDefault();
        alert('Please fill name, blood group and city.');
      }
    });
  }
});
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Register as Donor</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <header class="site-header container">
    <h1>Blood Donation Portal</h1>
    <nav><a href="index.html">Home</a> <a href="search.html">Search</a></nav>
  </header>

  <main class="container">
    <div class="form-card">
      <h2>Donor Registration</h2>
      <form id="donor-form" action="register.php" method="post">
        <label for="name">Full name</label>
        <input id="name" name="name" type="text" required>

        <label for="email">Email</label>
        <input id="email" name="email" type="email">

        <label for="phone">Phone</label>
        <input id="phone" name="phone" type="text">

        <label for="blood_group">Blood Group</label>
        <select id="blood_group" name="blood_group" required>
          <option value="">Choose</option>
          <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
          <option>AB+</option><option>AB-</option><option>O+</option><option>O-</option>
        </select>

        <label for="city">City</label>
        <input id="city" name="city" type="text" required>

        <label>
          <input type="checkbox" name="availability" value="1" checked> Available to donate
        </label>

        <input type="submit" value="Register">
      </form>
    </div>
  </main>

  <footer class="site-footer">
    <small>&copy; 2025 Blood Donation Portal</small>
  </footer>
  <script src="assets/script.js"></script>
</body>
</html>
<?php
require 'includes/connect.php';

$name = $_POST['name'] ?? '';
$email = $_POST['email'] ?? '';
$phone = $_POST['phone'] ?? '';
$blood = $_POST['blood_group'] ?? '';
$city = $_POST['city'] ?? '';
$availability = isset($_POST['availability']) ? 1 : 0;

if (!$name || !$blood || !$city) {
    echo "Missing required fields. <a href='register.html'>Go back</a>";
    exit;
}

// Use prepared statements to avoid SQL injection
$stmt = $conn->prepare("INSERT INTO donors (name,email,phone,blood_group,city,availability) VALUES (?,?,?,?,?,?)");
$stmt->bind_param("sssssi",$name,$email,$phone,$blood,$city,$availability);
if ($stmt->execute()) {
    echo "Thanks, $name. You are registered as a donor. <a href='index.html'>Home</a>";
} else {
    echo "Error: " . $conn->error;
}
$stmt->close();
$conn->close();
?>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Search Donors</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <header class="site-header container">
    <h1>Blood Donation Portal</h1>
    <nav><a href="index.html">Home</a> <a href="register.html">Register</a></nav>
  </header>

  <main class="container">
    <div class="form-card">
      <h2>Find Donors</h2>
      <form action="search.php" method="get">
        <label for="blood">Blood Group</label>
        <select id="blood" name="blood_group">
          <option value="">Any</option>
          <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
          <option>AB+</option><option>AB-</option><option>O+</option><option>O-</option>
        </select>

        <label for="city">City</label>
        <input id="city" name="city" type="text" placeholder="e.g., Chennai">

        <input type="submit" value="Search">
      </form>
    </div>

    <div id="results" class="search-results"></div>
  </main>

  <footer class="site-footer">
    <small>&copy; 2025 Blood Donation Portal</small>
  </footer>
</body>
</html>
<?php
require 'includes/connect.php';

$blood = $_GET['blood_group'] ?? '';
$city  = $_GET['city'] ?? '';

$sql = "SELECT id,name,email,phone,blood_group,city,availability FROM donors WHERE 1=1";
$params = [];
$types = '';

if ($blood !== '') {
    $sql .= " AND blood_group = ?";
    $params[] = $blood;
    $types .= 's';
}
if ($city !== '') {
    $sql .= " AND city LIKE ?";
    $params[] = "%$city%";
    $types .= 's';
}
$sql .= " ORDER BY created_at DESC LIMIT 200";

$stmt = $conn->prepare($sql);
if (!empty($params)) {
    $stmt->bind_param($types, ...$params);
}
$stmt->execute();
$res = $stmt->get_result();
?>
<!doctype html>
<html>
<head>
  <meta charset="utf-8"><title>Search Results</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <div class="container">
    <h2>Search Results</h2>
    <?php if ($res->num_rows === 0): ?>
      <p>No donors found. Try widening your search.</p>
    <?php else: ?>
      <table class="table">
        <thead><tr><th>Name</th><th>Blood</th><th>City</th><th>Contact</th><th>Available</th></tr></thead>
        <tbody>
        <?php while($row = $res->fetch_assoc()): ?>
          <tr>
            <td><?=htmlspecialchars($row['name'])?></td>
            <td><?=htmlspecialchars($row['blood_group'])?></td>
            <td><?=htmlspecialchars($row['city'])?></td>
            <td>
              <?php if($row['phone']): echo htmlspecialchars($row['phone']); ?>
              <?php elseif($row['email']): echo htmlspecialchars($row['email']); ?>
              <?php else: echo '-'; endif; ?>
            </td>
            <td><?= $row['availability'] ? 'Yes' : 'No' ?></td>
          </tr>
        <?php endwhile; ?>
        </tbody>
      </table>
    <?php endif; ?>
    <p><a href="search.html">Back to search</a></p>
  </div>
</body>
</html>
<?php
$stmt->close();
$conn->close();
?>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Post Blood Request</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <header class="site-header container">
    <h1>Blood Donation Portal</h1>
  </header>

  <main class="container">
    <div class="form-card">
      <h2>Post a Blood Request</h2>
      <form action="request.php" method="post">
        <label for="req-name">Your name</label>
        <input id="req-name" name="requester_name" type="text" required>

        <label for="contact">Contact (phone or email)</label>
        <input id="contact" name="contact" type="text">

        <label for="bg">Blood group needed</label>
        <select id="bg" name="blood_group" required>
          <option value="">Choose</option>
          <option>A+</option><option>A-</option><option>B+</option><option>B-</option>
          <option>AB+</option><option>AB-</option><option>O+</option><option>O-</option>
        </select>

        <label for="city">City</label>
        <input id="city" name="city" type="text" required>

        <label for="details">Additional details</label>
        <textarea id="details" name="details" rows="4"></textarea>

        <input type="submit" value="Post Request">
      </form>
    </div>
  </main>

  <footer class="site-footer">
    <small>&copy; 2025 Blood Donation Portal</small>
  </footer>
</body>
</html>
<?php
require 'includes/connect.php';

$name = $_POST['requester_name'] ?? '';
$contact = $_POST['contact'] ?? '';
$blood = $_POST['blood_group'] ?? '';
$city = $_POST['city'] ?? '';
$details = $_POST['details'] ?? '';

if (!$name || !$blood || !$city) {
    echo "Missing required fields. <a href='request.html'>Go back</a>";
    exit;
}

$stmt = $conn->prepare("INSERT INTO requests (requester_name,contact,blood_group,city,details) VALUES (?,?,?,?,?)");
$stmt->bind_param("sssss",$name,$contact,$blood,$city,$details);
if ($stmt->execute()) {
    echo "Request posted. Volunteers should reach out. <a href='index.html'>Home</a>";
} else {
    echo "Error: " . $conn->error;
}
$stmt->close();
$conn->close();
?>
<?php
require 'includes/connect.php';

$name = $_POST['requester_name'] ?? '';
$contact = $_POST['contact'] ?? '';
$blood = $_POST['blood_group'] ?? '';
$city = $_POST['city'] ?? '';
$details = $_POST['details'] ?? '';

if (!$name || !$blood || !$city) {
    echo "Missing required fields. <a href='request.html'>Go back</a>";
    exit;
}

$stmt = $conn->prepare("INSERT INTO requests (requester_name,contact,blood_group,city,details) VALUES (?,?,?,?,?)");
$stmt->bind_param("sssss",$name,$contact,$blood,$city,$details);
if ($stmt->execute()) {
    echo "Request posted. Volunteers should reach out. <a href='index.html'>Home</a>";
} else {
    echo "Error: " . $conn->error;
}
$stmt->close();
$conn->close();
?>
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Admin</title>
  <link rel="stylesheet" href="assets/styles.css">
</head>
<body>
  <div class="container">
    <h2>Admin panel (demo)</h2>
    <p>This page lists donors and requests. No auth implemented in demo — add login for real use.</p>
    <p><a href="admin.php">Open admin panel</a></p>
  </div>
</body>
</html>
<?php
require 'includes/connect.php';

if ($_SERVER['REQUEST_METHOD'] === 'POST' && isset($_POST['toggle_id'])) {
    $id = intval($_POST['toggle_id']);
    $stmt = $conn->prepare("UPDATE donors SET availability = 1 - availability WHERE id = ?");
    $stmt->bind_param("i",$id);
    $stmt->execute();
    $stmt->close();
    header("Location: admin.php");
    exit;
}

$donors = $conn->query("SELECT id,name,blood_group,city,phone,availability FROM donors ORDER BY created_at DESC");
$requests = $conn->query("SELECT id,requester_name,blood_group,city,contact,status,created_at FROM requests ORDER BY created_at DESC");
?>
<!doctype html>
<html>
<head><meta charset="utf-8"><title>Admin Panel</title><link rel="stylesheet" href="assets/styles.css"></head>
<body>
  <div class="container">
    <h2>Donors</h2>
    <table class="table">
      <thead><tr><th>Name</th><th>Blood</th><th>City</th><th>Contact</th><th>Available</th><th>Action</th></tr></thead>
      <tbody>
      <?php while($d = $donors->fetch_assoc()): ?>
        <tr>
          <td><?=htmlspecialchars($d['name'])?></td>
          <td><?=htmlspecialchars($d['blood_group'])?></td>
          <td><?=htmlspecialchars($d['city'])?></td>
          <td><?=htmlspecialchars($d['phone'])?></td>
          <td><?= $d['availability'] ? 'Yes' : 'No' ?></td>
          <td>
            <form method="post" style="display:inline">
              <input type="hidden" name="toggle_id" value="<?= $d['id'] ?>">
              <button type="submit">Toggle Availability</button>
            </form>
          </td>
        </tr>
      <?php endwhile; ?>
      </tbody>
    </table>

    <h2 style="margin-top:28px">Requests</h2>
    <table class="table">
      <thead><tr><th>Requester</th><th>Blood</th><th>City</th><th>Contact</th><th>Status</th><th>Date</th></tr></thead>
      <tbody>
      <?php while($r = $requests->fetch_assoc()): ?>
        <tr>
          <td><?=htmlspecialchars($r['requester_name'])?></td>
          <td><?=htmlspecialchars($r['blood_group'])?></td>
          <td><?=htmlspecialchars($r['city'])?></td>
          <td><?=htmlspecialchars($r['contact'])?></td>
          <td><?=htmlspecialchars($r['status'])?></td>
          <td><?=htmlspecialchars($r['created_at'])?></td>
        </tr>
      <?php endwhile; ?>
      </tbody>
    </table>

    <p><a href="index.html">Back to site</a></p>
  </div>
</body>
</html>
<?php
$conn->close();
?>
